     --------TD3------
___INSTRUMENTACION VIRTUAL___

_instrumento que admite datos binarios desde el exterior
_PC104: utiliza placa BUS ISA (averiguar)/sustituido por cable USB
_Interfaz paralelo:-BUS PCI
_Interfaz serie: -RS232
_slew rate: velocidad a la cual una señal pasa de un 1 a 0 o viceversa.
Se debe utilizar el slew rate mas lento que satisfaga mi sistema, que puede facilitar la eliminacion de ruido. Ademas consume mas corriente un slew rate con mayor velocidad debido a la conmutacion (capacitor del integrado)
_la velocidad de transmision de una longitud determinada de un cable de transmision dependera de su capcitancia distribuida y no del receptor en si.
!!!!!Averiguar conexion TTL!!!!!!

Modelo OSI
CONCENCPTOS BASICOS:
_redes:conjunto de equipos conectados entre si, con la capacidad de recibir y enviar datos.

 El modelo OSI (acrónimo de Open Systems Interconnection) es un modelo de referencia para la comunicación de datos en redes de computadoras.

 Capa física: se encarga de la transmisión de bits a través del medio físico de la red, como cables o señales inalámbricas.
1-Capa de enlace de datos: proporciona un enlace confiable entre dos nodos de la red y se encarga de la detección y corrección de errores en la transmisión.
2-Capa de red: se encarga del enrutamiento de los datos a través de la red, determinando la mejor ruta para enviarlos.
3-Capa de transporte: proporciona servicios de transporte de extremo a extremo, asegurando que los datos sean entregados de forma confiable y ordenada.
4-Capa de sesión: establece y gestiona las conexiones entre los dispositivos en la red, permitiendo la comunicación bidireccional.
5-Capa de presentación: se encarga de la representación de los datos, asegurando que sean entendidos correctamente por el receptor.
6-Capa de aplicación: proporciona servicios de aplicación para programas de usuario, como correo electrónico, navegadores web y mensajería instantánea.

clase 19/04
 estamos hablando del sistema embebido. el sistema que adquiere y transmite los datos software de la computadora es el instrumento virtual en cuanto a la parte de mostrar
 los datos e interpretar los datos y brindar información con esos datos, nosotros tenemos que desarrollar todos estos módulos Ya empezaron a probar lo que es la interfaz,
 hoy vamos a dar una vuelta de rosca la parte de interfaz que va a permitir que las entradas y las salidas que tienen distintos niveles de tensión que tienen distintos
  ipos de protecciones etcétera se comuniquen con la cpu y por otro lado la Fuente alimentación que va a proveer alimentación a todo el sistema.
 Tendremos que implementar un regulador de tension para alimentar el micro. La Blue pill creo que tiene un regulador lineal que baja de 5 a 3,3 entonces con que pongan
 un regulador de 5 va a ser suficiente. Para poder alimentar los acondicionadores señal van a tener que adaptar entrada de 10 voltios y de -+5 voltios de entrada
 las señales que vamos a manejar van a hacer estas las que están en esta filmina y va a ser puesto para en el trabajo. sí van a tener una cantidad mínima de entrada
  analógica de 8 así van a tener 8 canales de entrada analógica van a tener 8 conectores, cada conector con su masa para la señal analógica analógica van a soportar 
  tensiones de 0 a 10 V la salida que es 4095 después vamos a hacer un poco de caracterización con el Hardware para que aprendan Cómo se caracteriza y cómo se compensa.
 vamos a tener una entrada analógica que en lugar de trabajar de 0 a 10 voltios va a trabajar entre más menos 5 voltios para poder hacer esto y convertirlo a tres
  con tres van a tener que diseñar un acondicionador de señal para lo cual van a usar operacional
  para la entrada analógica van a tener dos salidas analógicas de resolución mínimos que van a salir por pwm, con un filtro vamos a tener la señal con la salida de 0 a 10 
  voltios, también ocho entradas digitales y ocho salidas digitales de la entrada de la salida digital es de 1 khz de frecuencia de muestra mínima.
 después a medida que avancemos, aumentamos la frecuencia de entrada del Canal pero la filtramos y mandamos a bajo frecuencia-
   la norma rs485 me dice únicamente los niveles de tensión o las características de los niveles de tensión que corresponden a esa Norma
    que vamos a usar de datos sería en este caso nosotros ya lo definimos tenemos el bit a la frecuencia definida la cantidad de bit el star y el Stop o sea todo ese Byte
 que definimos se va a encontrar en esta capa de datos y la capa de red ya lleva un protocolo un poquito más alto en donde nosotros vamos a definir lo que son los frames
  o los paquetes de datos en donde nosotros vamos a agregar información para poder hacer que nuestra comunicación sea confiable esto con la capa física 
  Es una constante O sea no es información puede tener información redundante que se genera con la información misma del dato para corrección y detección de errores
   eso es lo básico que presenta cualquier sistema de comunicaciones más o menos confiable
   Porque si yo transmito en binario mi dato siempre va a ser un byte uno dos lo que querramos pero es un byte me va a permitir a partir de lo otro que vamos a ver ahora
    mantener una trama de longitud constante
 pero lo que ustedes están almacenando si ustedes agarran un punto extra y transmite el punto exe no le importa y cuándo lo guarda el riverter tiene una un botoncito ahí
  en la parte de capture que les permite guardar en hexadecimal eso sí está bueno por qué Porque ustedes van a poder después fácilmente trabajarlo
la redundancia  son datos que yo puedo generar desde la información del código para detectar o corregir errores 
El crc lo que hace es procesar o meter toda esta información dentro de un algoritmo y generar del otro lado uno igual para luego compararlo
estos dos espacio de tiempo permiten ajustar mi canal de comunicación si el mismo sufrió un problema en el camino si yo tengo un canal de comunicación totalmente saturado
 es decir estoy usando el 100% del Canal,  para eso se ponen límites al uso del Canal y cómo lo hace acá el modback
  dice Bueno entre mensaje y mensaje tengo que dejar 3,5 bytes porque son el tiempo libre que a mí me permite acomodarme en caso de pérdida
acá van a tener que hacer la decodificación porque con eso los va a liberar para hacer cualquier tipo de protocolo que quieran que siempre es más fácil hacer un protocolo
 propio que hacer un estándar porque un estándar está muy pensado el protocolo propio cuando sea un protocolo es bastante fácil pero puede fallar 
 para que quedemos de acuerdo en principio la comunicación de ustedes va a ser full dúplex y va a ser ttl.
  Sí en el instrumento virtual hasta que lo conversamos a esa masa dejen un pin más del micro disponible para manejar la dirección de la RS 485 necesitamos una patita 
  déjenla ya prevista
   básicamente como mínimo como mínimo cabecera fija un contador este Contador se lo vamos a pedir porque en la mayoría de los instrumentos virtuales va a ser necesario
siempre tener alguna referencia temporal lo cual me consume más cantidad de byte. Por ejemplo yo sé que mi paquete de datos sale un milisegundo. Yo sé que
cada cuenta de este contador representa un milisegundo con lo cual puedo reconstruir mi forma de onda y saber qué tiempo pasó entre cada muestra
la misión es saber que no perdí tramas de un tamaño de 255. si perdí 512 bueno perdí tuve mala suerte le perdí justo
 vamos a poner el inicio un contador y la información para tener una longitud constante de frame, esto nos va a definir la longitud a esto le tenemos que sumar el byte

 siempre tiene que tener confirmación confirmación de estado en la salida digital hacerlo mejores que es muestrear la salida digital y mandar lo que estoy viendo 
porque los micros pueden leer el valor de sus Pines de salida leía el valor de la salida una entrada y veía el valor de la salida cuando yo leía un pin de salida me leía el valor eso tenías un problema que hace el el cómo se llama eso a uno yo cargo mucho la salida porque le pongo una resistencia muy baja cuando Yo leo la salida me le dé cero no me Lee uno entonces cuando hago una exon para hacer lindo y me queda siempre bien uno no cambia entonces si yo Leo la salida y te transmito lo que yo estoy sacando por lo menos voy hasta la salida del micro saber que lo que vos pusiste está saliendo la confiabilidad que necesita en tu instrumento para poder verificar que son cuestiones que hay que tener en cuenta cuando uno diseña para que tengan confiabilidad la sangre los instrumentos vamos a usar el 0x1b va a ir siempre la cabecera de su trama el siguiente va a ser el contador el contador de 0 a 255 sí le voy a pedir que esté el instrumento virtual tenemos que poder graficar la historia de nuestras tramas una trama perfecta el siglo se perdió ningún dato en toda mi lectura cuando yo tengo pérdida de datos lo que yo voy a ver por ejemplo perfectamente valor y calculo cuánto tiempo de pérdida de datos tengo para eso se usa el contador o sea esto tenemos que poder Mostrar nunca va a haber problema contador sí tiene que ser del tipo alzheimer llegase negativo le va a empezar a descontar uno y así el contador también entra dentro de la parte del crc no el contador sigue soy vaya analizando esto y cuando llegue acá te lo va a comparar con lo que te mandaron sí información pero solo dos o tres transmisiones de usar por trama una estructura vas a poner el contador va a poner la información y el crc y ahí le pones que transmita por interrupción los datos de tu estructura deja transmitir Cuando vos volví a generar datos volver a escribir la estructura e incrementa el contador en un nivel Superior la transmisión me viene me busca y yo vuelvo a cargar la FIFA de transmisión a trabajar con la idea que usen todas esas propiedades del micro Y esto es por trama o sea esto cada vez que yo guardo una nueva trama en esa Estructura de datos después del contador viene la información de una cadena Armada tal cual estoy diciendo idea de pasar de algunos para que renieguen lo decodifiquen con python y maldad en un momento para poder graficar si ustedes se fijan tienen algunos celulares con las computadoras empieza con uno b y lo que le sigue es el contador de ahí hasta el próximo uno ve en la trama de datos lo que yo quiera Entonces esto es lo que nosotros tenemos que formar con nuestro sistema cuando recibe esto es realte recibiendo y guardando en Excel práctico para qué Para que lo primero que ustedes hagan sea con instrumentos virtual por ejemplo podrían decir Bueno voy a mandar los datos y voy a incrementar todos estos datos en uno todos en uno para poder graficar y van a poder ver que realmente el mecanismo de comunicaciones que va a tener base que va a tener lugar todo funciona correctamente las cosas se van haciendo de a poquito Entonces vamos a hacer las cosas y las vamos a probar Ahora tiene una herramienta para verificar Usan el real Tech y usan un comparador de archivo porque es muy útil y es muy fácil para hacer esto es genial en cinco líneas arman todos los archivos que necesitan de esto sí no hace falta no debería Pero puede ser porque esto era el principio del archivo y hay un problema que cuando ustedes almacenan Esto está transmitiendo 460,800 a esa velocidad mecanismo de Windows y todo el instrumento virtual es otra cosa porque a ver esa otra cosa importante información prioridad a esa tarea inclusive hay otra cosa este sistema no tiene crc por lo tanto Qué haces cuando este sistema para la decodificación en python una cosa que le recomiendo hacer es imprimir siempre las cabeceras porque ustedes tu sistema tiene como van a ser ustedes también largo fijo hacer un bucle sacando los datos a partir del 1b y descomponiendo en distintos parámetros que son los que van a guardar trabajo siguiente trabajo que pueden hacerlo con python de forma manual te digo se produce el problema al principio del archivo si no tienen que hacer algo para buscar esa información donde se pierde ir a la parte del archivo donde se pierde y borrar la parte que está molestando si me molesta que se pierda entonces tengo que usar un mecanismo de retransmisión pero es distinto porque esto es un caso de capturar muchos datos para eso tienes que tener tiempo por eso lento bien estamos hasta ahí alguna pregunta más de una semana muchos mecanismos de crc y hay dos o sea digamos que hay dos universos muy grandes de crc uno que utilizan los bloques de datos como el Salomón o ese tipo de crc que son sistemas para verificar bloques de información son crc para verificar bloquecitos de información controlando y esto que están que están viendo por acá son realimentaciones de la salida Este crc funciona metiendo todos los datos binarios en serie plaza y va realimentando por acá los datos binarios de información salido una vez que yo terminé pasar el dato desde el primer dato al último dato eso tengo un número ese número se lo pongo en el al final del frame y lo mando el receptor hace Exactamente lo mismo y genera su número si no son iguales hay algo mal y en la clave Dónde está estadísticamente se generaron determinadas combinaciones que aseguran que tengan mayor o menor confiabilidad hasta el último y manda el resultado del otro lado el receptor hace una exhor de todo me tiene que dar cero inclusive les da la fórmula de que ustedes puedan entrar por tabla a buscar el resultado es como una opción que tienen porque es bastante más complejo el alcohol fueron correctos una máquina por lo tanto es muy importante que sea correcto la información depende de la Norma O sea hay normas que te especifican que empieza desde el primer byte de datos o sea incluyendo la cabecera hay otra que te dice que va únicamente la trama de datos otro que dicen trama y contador o etcétera contador está presente en muchísimas normas de trabajo esto no lo vamos a poner por ahora en el instrumento virtual por ahora ven entonces antes de pasar el acondicionamiento de señal cálculo muy simple de qué frecuencia máxima podemos hacer utilizar en nuestro instrumento virtual a lo cual vamos a usar simplemente esto sí sí de la entrada vamos a tener que preguntar o sea vamos a tener que leer el estado de los ocho Pines el estado de o sea uno dividido 8 o uno para el coche porque el micro trabaja a 70 que tu frecuencia muestra el resultado tú no va a ser el mismo Cuál sería la frecuencia máxima que tendría que tener una entrada para no perder información 0,5 leer a un milisegundo a un milisegundo más 100 microsegundos Exactamente lo mismo externo que se muestre a un milisegundo la forma ideal 34 o 574 que son ocho free Flow en cadena y mandás con el micro un club a un milisegundo yo tengo que poner ese club y muestrear todo arrancar a hacer la lectura a las 8 y no importa si después en 20 en unos segundos sí pero si en un milisegundo igual que para la entrada analógica cómo estás analógicas y actualizar las salidas digitales llega la información del dato digital nuevo lo voy a guardar una memoria instrucciones tienen que trabajar por interrupción vamos a un sistema de control cuando veamos sistema de control digital todo se basa en la muestra siempre se corre dentro de la interrupción pero sí me importa el ciclo entre instantes pero el otro tiene que ser justo justo tema un Delta que va a poder tener una dos tres cuatro instrucciones por eso los micro trabajan a 70 megas y manejan sistemas a 10 kilos Espero que los viernes pregunten la misma cantidad de cosas no voy a estar pero el otro sí voy a ir después cuando haga falta la velocidad lo guardamos una estructura y los leemos y lo mandamos por el puerto serie la misma espacio de memoria compartido cómo lo mandamos por el puerto serie entero porque el puerto serie soporta 8 bits qué opción tengo empezar a rotar y sacar rotar y sacar o poner unan lo más fácil es guardar ese entero en una Unión que tenga cuatro vamos a Puerto y vamos a ver la máxima velocidad que tiene 921,600 vamos a trabajar a 460,800 audios 70% del ancho de banda del canal 460 800 habría que dividirlo dividido 4 dividido 240 * 07 o sea tenemos 1,3 K por lo tanto vamos a estar más quebrados para lo 1 kg de la entrada de salida digital casualidad esa sería la frecuencia máxima a la cual nosotros podríamos transmitir la información de realidad vos tendrías que Mostrar al doble para mandar siempre porque si no puedes mandar dos veces el mismo por algún motivo puede estar mandado a veces repetido y del otro gato va bueno bien la otra cosa que le voy a aclarar a ustedes vieron que las entradas tienen positivo y negativo tenemos una entrada analógica pero la fuente de usted va a ser siempre de 0 a 12 voltios por lo tanto no pueden usar el amplificador inversor solo no y otra cosa para poder mandar $0 porque sino si no usan red lo mínimo que saca de 1,20 más o menos y usted tiene que ser capaces de poner 0 voltios en la entrada del conversor y alguna otra cosa que se me esté olvidando creo que ninguna Así que lo que se va a hacer el día viernes aquello primero di más va a dar la clase del uso software para la Gráfica ustedes van a empezar a diseñar virtuales para poder graficar y ver en el software las simulación la salida después de eso cuando ya vayamos completando la otra parte vamos a armar la placa y van a hacer una caracterización de ese anclaje de ver por lo menos le va a mostrar las características básica